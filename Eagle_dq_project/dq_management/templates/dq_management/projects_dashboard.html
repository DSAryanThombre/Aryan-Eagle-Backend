    <!DOCTYPE html>
{% load static %}
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Eagle DQ - Projects Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="icon" href="{% static 'dq_management/images/eagle_logo_bg.png' %}" type="image/png" />
    <style>
        /* ... existing CSS code ... */
        /* CSS Variables for Theme Colors */
        :root {
            /* Light Theme Colors */
            --bg-primary: linear-gradient(135deg, #fef7ed 0%, #fdf4ff 25%, #f0f9ff 50%, #f0fdfa 75%, #fefce8 100%);
            --bg-overlay: radial-gradient(circle at 20% 80%, rgba(251, 191, 36, 0.08) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(14, 165, 233, 0.06) 0%, transparent 50%),
                radial-gradient(circle at 40% 40%, rgba(139, 92, 246, 0.05) 0%, transparent 50%),
                radial-gradient(circle at 60% 60%, rgba(236, 72, 153, 0.04) 0%, transparent 50%);

            --sidebar-bg: linear-gradient(180deg, rgba(255, 255, 255, 0.95) 0%, rgba(254, 252, 232, 0.9) 50%, rgba(240, 249, 255, 0.9) 100%);
            --sidebar-border: rgba(251, 191, 36, 0.1);
            --sidebar-shadow: 2px 0 20px rgba(251, 191, 36, 0.1);

            --card-bg: linear-gradient(135deg, rgba(255, 255, 255, 0.9) 0%, rgba(254, 252, 232, 0.3) 25%, rgba(240, 249, 255, 0.3) 75%, rgba(255, 255, 255, 0.9) 100%);
            --card-border: rgba(251, 191, 36, 0.1);
            --card-shadow: 0 8px 32px rgba(251, 191, 36, 0.08);

            --project-card-bg: rgba(255, 255, 255, 0.98);
            --project-card-border: rgba(251, 191, 36, 0.15);
            --project-card-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
            --project-card-hover-shadow: 0 25px 50px rgba(251, 191, 36, 0.2);
            --project-card-hover-border: rgba(14, 165, 233, 0.3);

            --text-primary: #1e293b;
            --text-secondary: #475569;
            --text-tertiary: #64748b;
            --text-muted: #94a3b8;

            --nav-link-color: #475569;
            --nav-link-hover: #334155;
            --nav-link-active-bg: linear-gradient(135deg, rgba(251, 191, 36, 0.12) 0%, rgba(14, 165, 233, 0.08) 100%);
            --nav-link-active-color: #1e293b;

            --search-bg: linear-gradient(135deg, rgba(255, 255, 255, 0.95) 0%, rgba(254, 252, 232, 0.3) 50%, rgba(240, 249, 255, 0.3) 100%);
            --search-border: rgba(251, 191, 36, 0.1);
            --search-focus-border: rgba(251, 191, 36, 0.3);
            --search-focus-shadow: 0 0 0 4px rgba(251, 191, 36, 0.08);

            --toggle-btn-bg: linear-gradient(135deg, rgba(255, 255, 255, 0.95) 0%, rgba(254, 252, 232, 0.8) 100%);
            --toggle-btn-border: rgba(251, 191, 36, 0.15);
            --toggle-btn-shadow: 0 4px 12px rgba(251, 191, 36, 0.12);
        }

        /* Dark Theme Colors */
        [data-theme="dark"] {
            --bg-primary: linear-gradient(135deg, #000000 0%, #1a1a1a 25%, #2a2a2a 50%, #1a1a1a 75%, #000000 100%);
            --bg-overlay: radial-gradient(circle at 20% 80%, rgba(255, 255, 255, 0.02) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(255, 255, 255, 0.01) 0%, transparent 50%),
                radial-gradient(circle at 40% 40%, rgba(255, 255, 255, 0.015) 0%, transparent 50%),
                radial-gradient(circle at 60% 60%, rgba(255, 255, 255, 0.01) 0%, transparent 50%);

            --sidebar-bg: linear-gradient(180deg, rgba(0, 0, 0, 0.95) 0%, rgba(20, 20, 20, 0.9) 50%, rgba(10, 10, 10, 0.9) 100%);
            --sidebar-border: rgba(255, 255, 255, 0.1);
            --sidebar-shadow: 2px 0 20px rgba(0, 0, 0, 0.5);

            --card-bg: linear-gradient(135deg, rgba(20, 20, 20, 0.9) 0%, rgba(30, 30, 30, 0.3) 25%, rgba(25, 25, 25, 0.3) 75%, rgba(20, 20, 20, 0.9) 100%);
            --card-border: rgba(255, 255, 255, 0.1);
            --card-shadow: 0 8px 32px rgba(0, 0, 0, 0.5);

            --project-card-bg: rgba(20, 20, 20, 0.95);
            --project-card-border: rgba(255, 255, 255, 0.15);
            --project-card-shadow: 0 4px 12px rgba(0, 0, 0, 0.5);
            --project-card-hover-shadow: 0 25px 50px rgba(0, 0, 0, 0.7);
            --project-card-hover-border: rgba(255, 255, 255, 0.2);

            --text-primary: #ffffff;
            --text-secondary: #e0e0e0;
            --text-tertiary: #c0c0c0;
            --text-muted: #808080;

            --nav-link-color: #e0e0e0;
            --nav-link-hover: #ffffff;
            --nav-link-active-bg: linear-gradient(135deg, rgba(255, 255, 255, 0.1) 0%, rgba(255, 255, 255, 0.05) 100%);
            --nav-link-active-color: #ffffff;

            --search-bg: linear-gradient(135deg, rgba(20, 20, 20, 0.95) 0%, rgba(30, 30, 30, 0.4) 50%, rgba(25, 25, 25, 0.4) 100%);
            --search-border: rgba(255, 255, 255, 0.1);
            --search-focus-border: rgba(255, 255, 255, 0.2);
            --search-focus-shadow: 0 0 0 4px rgba(255, 255, 255, 0.1);

            --toggle-btn-bg: linear-gradient(135deg, rgba(20, 20, 20, 0.95) 0%, rgba(30, 30, 30, 0.8) 100%);
            --toggle-btn-border: rgba(255, 255, 255, 0.15);
            --toggle-btn-shadow: 0 4px 12px rgba(0, 0, 0, 0.5);
        }

        body {
            display: flex;
            min-height: 100vh;
            background: var(--bg-primary);
            font-family: 'Inter', sans-serif;
            margin: 0;
            position: relative;
            color: var(--text-secondary);
            transition: all 0.3s ease;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: var(--bg-overlay);
            pointer-events: none;
            z-index: -1;
            transition: all 0.3s ease;
        }

        .sidebar {
            position: fixed;
            top: 0;
            left: 0;
            width: 280px;
            height: 100vh;
            background: var(--sidebar-bg);
            backdrop-filter: blur(20px);
            box-shadow: var(--sidebar-shadow);
            padding: 2rem;
            display: flex;
            flex-direction: column;
            align-items: center;
            flex-shrink: 0;
            transition: margin-left 0.3s ease;
            z-index: 40;
            border-right: 1px solid var(--sidebar-border);
        }

        .main-content-wrapper {
            flex-grow: 1;
            padding: 1.5rem;
            overflow-y: auto;
            transition: margin-left 0.3s ease;
            margin-left: 280px;
        }

        .main-content-card {
            background: var(--card-bg);
            backdrop-filter: blur(20px);
            padding: 2.5rem;
            border-radius: 1.5rem;
            box-shadow: var(--card-shadow);
            border: 1px solid var(--card-border);
            transition: all 0.3s ease;
        }

        .logo-container {
            background: transparent;
            border-radius: 0.5rem;
            padding: 0.25rem 0.5rem;
            margin-bottom: 1.25rem;
            box-shadow: none;
            border: none;
            backdrop-filter: none;
        }

        .site-header-logo {
            width: 40px;
            height: 40px;
            object-fit: contain;
            margin-right: 0.5rem;
            vertical-align: middle;
        }

        .nav-link {
            display: flex;
            align-items: center;
            width: 100%;
            padding: 1rem 1.25rem;
            border-radius: 0.75rem;
            color: var(--nav-link-color);
            font-weight: 500;
            transition: all 0.3s ease;
            margin-bottom: 0.5rem;
            position: relative;
            overflow: hidden;
        }

        .nav-link::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 0;
            height: 100%;
            background: linear-gradient(90deg, rgba(59, 130, 246, 0.1) 0%, rgba(168, 85, 247, 0.05) 100%);
            transition: width 0.3s ease;
            z-index: -1;
        }

        .nav-link:hover::before {
            width: 100%;
        }

        .nav-link:hover {
            color: var(--nav-link-hover);
            transform: translateX(4px);
        }

        .nav-link.active {
            background: var(--nav-link-active-bg);
            color: var(--nav-link-active-color);
            font-weight: 600;
            box-shadow: 0 2px 8px rgba(59, 130, 246, 0.15);
        }

        .nav-link i {
            margin-right: 1rem;
            width: 20px;
            text-align: center;
            transition: transform 0.3s ease;
        }

        .nav-link:hover i {
            transform: scale(1.1);
        }

        /* Enhanced Project Card Styling with Dark Mode */
        .project-card {
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            border-radius: 1rem;
            background: var(--project-card-bg);
            backdrop-filter: blur(20px);
            border: 1px solid var(--project-card-border);
            padding: 1.5rem;
            position: relative;
            overflow: hidden;
            cursor: pointer;
            box-shadow: var(--project-card-shadow);
        }

        .project-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: linear-gradient(90deg, transparent 0%, #3b82f6 25%, #a855f7 75%, transparent 100%);
            transform: scaleX(0);
            transform-origin: left;
            transition: transform 0.5s ease;
        }

        .project-card:hover::before {
            transform: scaleX(1);
        }

        .project-card:hover {
            transform: translateY(-8px);
            box-shadow: var(--project-card-hover-shadow);
            border-color: var(--project-card-hover-border);
        }

        .add-project-card {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            min-height: 200px;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            border-radius: 1rem;
            border: 2px dashed var(--project-card-border);
            background: var(--project-card-bg);
            box-shadow: none;
            cursor: pointer;
            opacity: 0.8;
        }

        .add-project-card:hover {
            border-color: var(--project-card-hover-border);
            background: var(--project-card-bg);
            transform: scale(1.03);
            box-shadow: var(--project-card-hover-shadow);
            opacity: 1;
        }

        .search-input {
            transition: all 0.3s ease;
            border-radius: 1rem;
            background: var(--search-bg);
            border: 1px solid var(--search-border);
            backdrop-filter: blur(20px);
            color: var(--text-secondary);
        }

        .search-input::placeholder {
            color: var(--text-muted);
        }

        .search-input:focus {
            border-color: var(--search-focus-border);
            box-shadow: var(--search-focus-shadow);
            background: var(--search-bg);
            transform: scale(1.02);
            outline: none;
        }

        /* Status Colors - Dark Mode Compatible */
        .status-pass {
            background: #064e3b;
            color: #6ee7b7;
            border: 1px solid #065f46;
        }

        .status-fail {
            background: #7f1d1d;
            color: #fca5a5;
            border: 1px solid #991b1b;
        }

        .status-warn {
            background: #78350f;
            color: #fcd34d;
            border: 1px solid #92400e;
        }

        .status-default {
            background: var(--project-card-bg);
            color: var(--text-secondary);
            border: 1px solid var(--project-card-border);
        }

        [data-theme="light"] .status-pass {
            background: #ecfdf5;
            color: #047857;
            border: 1px solid #d1fae5;
        }

        [data-theme="light"] .status-fail {
            background: #fef2f2;
            color: #b91c1c;
            border: 1px solid #fee2e2;
        }

        [data-theme="light"] .status-warn {
            background: #fffdf5;
            color: #b45309;
            border: 1px solid #fde68a;
        }

        [data-theme="light"] .status-default {
            background: #f1f5f9;
            color: #475569;
            border: 1px solid #e2e8f0;
        }

        .header-title {
            background: linear-gradient(135deg, var(--text-primary) 0%, var(--text-secondary) 50%, #3b82f6 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .priority-badge {
            background: #fef3c7;
            color: #78350f;
            border: 1px solid #fde68a;
            font-weight: 600;
            padding: 0.25rem 0.75rem;
        }

        [data-theme="dark"] .priority-badge {
            background: #78350f;
            color: #fcd34d;
            border: 1px solid #92400e;
        }

        .toggle-btn {
            background: var(--toggle-btn-bg);
            backdrop-filter: blur(20px);
            border: 1px solid var(--toggle-btn-border);
            color: var(--text-secondary);
            box-shadow: var(--toggle-btn-shadow);
            transition: all 0.3s ease;
        }

        .toggle-btn:hover {
            transform: scale(1.05);
            box-shadow: var(--toggle-btn-shadow);
        }

        /* Dark Mode Toggle Button */
        .dark-mode-toggle {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 50;
            background: var(--toggle-btn-bg);
            backdrop-filter: blur(20px);
            border: 1px solid var(--toggle-btn-border);
            color: var(--text-secondary);
            box-shadow: var(--toggle-btn-shadow);
            border-radius: 50%;
            width: 48px;
            height: 48px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .dark-mode-toggle:hover {
            transform: scale(1.1);
            box-shadow: var(--toggle-btn-shadow);
        }

        .dark-mode-toggle i {
            font-size: 1.2rem;
            transition: transform 0.3s ease;
        }

        .dark-mode-toggle:hover i {
            transform: rotate(180deg);
        }

        /* Update text colors for dark mode */
        .project-card h3,
        .project-card p,
        .project-card span,
        .project-card code {
            color: var(--text-secondary);
            transition: color 0.3s ease;
        }

        .project-card .text-slate-500 {
            color: var(--text-muted) !important;
        }

        .project-card .text-slate-600 {
            color: var(--text-tertiary) !important;
        }

        .project-card .text-slate-700 {
            color: var(--text-secondary) !important;
        }

        .project-card .text-slate-800 {
            color: var(--text-primary) !important;
        }

        .project-card .bg-slate-100 {
            background: var(--project-card-border) !important;
        }

        /* Criticality badge dark mode */
        .project-card .bg-red-100 {
            background: #7f1d1d !important;
        }

        .project-card .text-red-800 {
            color: #fca5a5 !important;
        }

        .project-card .border-red-200 {
            border-color: #991b1b !important;
        }

        [data-theme="light"] .project-card .bg-red-100 {
            background: #fef2f2 !important;
        }

        [data-theme="light"] .project-card .text-red-800 {
            color: #b91c1c !important;
        }

        [data-theme="light"] .project-card .border-red-200 {
            border-color: #fee2e2 !important;
        }

        /* Message alerts dark mode */
        [data-theme="dark"] .bg-gradient-to-r.from-green-50 {
            background: linear-gradient(to right, rgba(6, 78, 59, 0.3), rgba(4, 120, 87, 0.3)) !important;
        }

        [data-theme="dark"] .text-green-800 {
            color: #6ee7b7 !important;
        }

        [data-theme="dark"] .border-green-200 {
            border-color: rgba(6, 95, 70, 0.5) !important;
        }

        [data-theme="dark"] .bg-gradient-to-r.from-red-50 {
            background: linear-gradient(to right, rgba(127, 29, 29, 0.3), rgba(153, 27, 27, 0.3)) !important;
        }

        [data-theme="dark"] .text-red-800 {
            color: #fca5a5 !important;
        }

        [data-theme="dark"] .border-red-200 {
            border-color: rgba(153, 27, 27, 0.5) !important;
        }

        [data-theme="dark"] .bg-gradient-to-r.from-blue-50 {
            background: linear-gradient(to right, rgba(30, 58, 138, 0.3), rgba(37, 99, 235, 0.3)) !important;
        }

        [data-theme="dark"] .text-blue-800 {
            color: #93c5fd !important;
        }

        [data-theme="dark"] .border-blue-200 {
            border-color: rgba(37, 99, 235, 0.5) !important;
        }

        @media (max-width: 768px) {
            .sidebar {
                width: 260px;
            }

            .main-content-wrapper {
                margin-left: 260px;
            }

            .dark-mode-toggle {
                top: 10px;
                right: 10px;
                width: 40px;
                height: 40px;
            }
        }
    </style>
</head>

<body class="text-slate-800">
    {% csrf_token %}

    {% include 'dq_management/includes/sidebar.html' %}



    <button id="sidebarToggleBtn"
        class="toggle-btn fixed bottom-6 left-6 z-50 rounded-full p-3 shadow-lg focus:outline-none transition-all duration-300 flex items-center justify-center"
        style="width: 48px; height: 48px;">
        <span id="sidebarToggleIcon" style="font-size: 1.25rem;">
            <i class="fas fa-chevron-left"></i>
        </span>
    </button>

    <div id="mainContent" class="main-content-wrapper transition-all duration-300">
        <header class="main-content-card mb-8">
            <div class="max-w-7xl mx-auto text-center">
                <div class="flex items-center justify-center mb-4">
                    <i
                        class="fas fa-feather-alt text-3xl bg-gradient-to-r from-amber-500 to-blue-500 bg-clip-text text-transparent mr-3"></i>
                    <h1 class="text-4xl font-bold header-title">
                        Projects Overview
                    </h1>
                </div>
                <p class="mb-8 text-lg" style="color: var(--text-tertiary);">Monitor and manage your data quality
                    projects</p>

                <div class="max-w-5xl mx-auto grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 justify-center">
                    <div class="relative">
                        <i class="fas fa-search absolute left-4 top-1/2 transform -translate-y-1/2"
                            style="color: var(--text-muted);"></i>
                        <input id="projectFilterInput" oninput="filterProjects()" type="text"
                            placeholder="Search by project name..."
                            class="search-input w-full pl-12 pr-4 py-3 text-sm focus:outline-none">
                    </div>
                    <div class="relative">
                        <i class="fas fa-hashtag absolute left-4 top-1/2 transform -translate-y-1/2"
                            style="color: var(--text-muted);"></i>
                        <input id="projectIdFilterInput" oninput="filterProjects()" type="text"
                            placeholder="Filter by ID..."
                            class="search-input w-full pl-12 pr-4 py-3 text-sm focus:outline-none">
                    </div>

                    <div class="relative">
                        <i class="fas fa-exclamation-triangle absolute left-4 top-1/2 transform -translate-y-1/2"
                            style="color: var(--text-muted);"></i>
                        <input id="criticalityFilterInput" oninput="filterProjects()" type="text"
                            placeholder="Filter by Criticality..."
                            class="search-input w-full pl-12 pr-4 py-3 text-sm focus:outline-none">
                    </div>
                </div>
            </div>
        </header>

        <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 pb-8">
            {% if messages %}
            <div class="mb-6">
                {% for message in messages %}
                <div class="p-4 mb-4 rounded-xl text-sm font-medium border backdrop-filter backdrop-blur-sm
                    {% if 'success' in message.tags %}
                        bg-gradient-to-r from-green-50 to-emerald-50 text-green-800 border-green-200
                    {% elif 'error' in message.tags %}
                        bg-gradient-to-r from-red-50 to-rose-50 text-red-800 border-red-200
                    {% else %}
                        bg-gradient-to-r from-blue-50 to-sky-50 text-blue-800 border-blue-200
                    {% endif %}">
                    <div class="flex items-center">
                        {% if 'success' in message.tags %}
                        <i class="fas fa-check-circle mr-2"></i>
                        {% elif 'error' in message.tags %}
                        <i class="fas fa-exclamation-circle mr-2"></i>
                        {% else %}
                        <i class="fas fa-info-circle mr-2"></i>
                        {% endif %}
                        {{ message }}
                    </div>
                </div>
                {% endfor %}
            </div>
            {% endif %}

            <section class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">

                <a href="{% url "create_project" %}" class="add-project-card group w-full">
                    <div class="flex flex-col items-center p-4">
                        <i
                            class="fas fa-plus-circle text-6xl text-amber-500 group-hover:text-blue-500 transition-colors duration-300"></i>
                        <h3 class="mt-4 text-xl font-bold group-hover:text-slate-800 transition-colors duration-300"
                            style="color: var(--text-secondary);">
                            Add New Project
                        </h3>
                        <p class="text-sm mt-1" style="color: var(--text-muted);">Define data quality goals</p>
                    </div>
                </a>

                {% if projects %}
                {% for project in projects %}

                <div class="project-card group w-full relative" data-project-name="{{ project.project_name }}"
                    data-project-id="{{ project.project_id }}" data-project-priority="{{ project.priority }}"
                    data-project-criticality="{{ project.criticality_level }}">

                    <a href="{% url 'project_details' project_id=project.project_id %}"
                        class="absolute inset-0 z-10"></a>

                    <div class="flex items-start justify-between mb-3 relative z-20">
                        <div class="flex-1 min-w-0">
                            <div class="flex items-center mb-2">
                                <i class="fas fa-folder-open mr-2 group-hover:text-slate-600 transition-colors"
                                    style="color: var(--text-muted);"></i>
                                <h3 class="text-sm md:text-base lg:text-lg font-semibold group-hover:text-slate-900 transition-colors truncate"
                                    style="color: var(--text-primary);" title="{{ project.project_name }}">
                                    {{ project.project_name }}
                                </h3>
                            </div>
                            {% if project.project_description %}
                            <p class="text-xs md:text-sm lg:text-base line-clamp-2" style="color: var(--text-tertiary);"
                                title="{{ project.project_description }}">{{ project.project_description }}</p>
                            {% endif %}
                        </div>

                        <div class="flex items-center space-x-2">
                            <div class="flex opacity-0 group-hover:opacity-100 transition-opacity duration-300">
                                <a href="{% url 'edit_project' project_id=project.project_id %}"
                                    class="hover:text-blue-500 transition-colors p-1 rounded-full hover:bg-slate-100 relative z-30"
                                    style="color: var(--text-muted);" title="Edit Project Details"
                                    onclick="event.stopPropagation()">
                                    <i class="fas fa-edit text-sm"></i>
                                </a>
                            </div>

                            {% if project.status and project.status != 'N/A' %}
                            <span class="px-3 py-1 rounded-full text-xs font-medium relative z-20
                                {% if project.status == 'PASS' %}status-pass
                                {% elif project.status == 'FAIL' %}status-fail
                                {% elif project.status == 'WARN' %}status-warn
                                {% else %}status-default{% endif %}">
                                {{ project.status }}
                            </span>
                            {% endif %}
                        </div>
                    </div>

                    <div class="space-y-3 pt-3 border-t relative z-20"
                        style="border-color: var(--project-card-border);">
                        {% if project.project_id %}
                        <div class="flex items-center justify-between">
                            <span class="text-sm" style="color: var(--text-muted);">Project ID</span>
                            <code class="px-2 py-1 rounded text-sm font-mono font-medium"
                                style="background: var(--project-card-border); color: var(--text-secondary);">
                                {{ project.project_id }}
                            </code>
                        </div>
                        {% endif %}

                        {% if project.priority %}
                        <div class="flex items-center justify-between">
                            <span class="text-sm" style="color: var(--text-muted);">Priority</span>
                            <span class="priority-badge px-3 py-1 rounded-full text-sm font-semibold">
                                {{ project.priority }}
                            </span>
                        </div>
                        {% endif %}

                        {% if project.criticality_level %}
                        <div class="flex items-center justify-between">
                            <span class="text-sm" style="color: var(--text-muted);">Criticality</span>
                            <span
                                class="px-3 py-1 rounded-full text-sm font-semibold bg-red-100 text-red-800 border border-red-200">
                                {{ project.criticality_level }}
                            </span>
                        </div>
                        {% endif %}

                        {% if project.updated_at %}
                        <div>
                            <div class="flex items-center text-sm" style="color: var(--text-muted);">
                                <i class="far fa-clock mr-2"></i>
                                <span>Updated {{ project.updated_at|date:"M j, Y H:i:s"|default:"N/A" }}</span>
                            </div>
                        </div>
                        {% endif %}
                    </div>
                </div>
                {% endfor %}
                {% else %}
                <div class="col-span-full text-center py-12" id="emptyState">
                    <i class="fas fa-folder-open text-6xl mb-4" style="color: var(--text-muted);"></i>
                    <h3 class="text-xl font-semibold mb-2" style="color: var(--text-tertiary);">No projects found</h3>
                    <p style="color: var(--text-muted);">Start by creating your first data quality project</p>
                </div>
                {% endif %}

            </section>
        </main>
    </div>

    <div id="projectModal" class="hidden"></div>

    <script>
        // Dark Mode Functionality - handled by sidebar
        const body = document.body;

        // Check for saved theme preference or default to light mode
        const currentTheme = localStorage.getItem('eagle-dq-theme') || 'light';
        body.setAttribute('data-theme', currentTheme);

        // Listen for theme changes from sidebar
        window.addEventListener('themeChanged', function(e) {
            const theme = e.detail.theme;
            body.setAttribute('data-theme', theme);
        });

        // Sidebar and filter functions
        const sidebar = document.getElementById('sidebar');
        const mainContent = document.getElementById('mainContent');
        const toggleBtn = document.getElementById('sidebarToggleBtn');
        const toggleIcon = document.getElementById('sidebarToggleIcon');
        let sidebarVisible = true;

        function getSidebarWidth() {
            return (sidebar && sidebar.offsetWidth) ? sidebar.offsetWidth : 280;
        }

        function hideSidebar() {
            const w = getSidebarWidth();
            sidebar.style.marginLeft = `-${w}px`;
            mainContent.style.marginLeft = '0';
            toggleIcon.innerHTML = '<i class="fas fa-chevron-right"></i>';
            sidebarVisible = false;
        }

        function showSidebar() {
            const w = getSidebarWidth();
            sidebar.style.marginLeft = '0';
            mainContent.style.marginLeft = `${w}px`;
            toggleIcon.innerHTML = '<i class="fas fa-chevron-left"></i>';
            sidebarVisible = true;
        }

        toggleBtn.addEventListener('click', function () {
            if (sidebarVisible) {
                hideSidebar();
            } else {
                showSidebar();
            }
        });

        function filterProjects() {
            const nameInput = document.getElementById('projectFilterInput').value.toLowerCase();
            const idInput = document.getElementById('projectIdFilterInput').value.toLowerCase();
            const criticalityInput = document.getElementById('criticalityFilterInput').value.toLowerCase();

            const cards = document.querySelectorAll('.project-card');
            let found = false;

            cards.forEach((card, index) => {
                const name = card.dataset.projectName ? card.dataset.projectName.toLowerCase() : '';
                const id = card.dataset.projectId ? card.dataset.projectId.toLowerCase() : '';
                const criticality = card.dataset.projectCriticality ? card.dataset.projectCriticality.toLowerCase() : '';

                const matchesName = name.includes(nameInput);
                const matchesId = id.includes(idInput);
                const matchesCriticality = criticalityInput === '' || criticality.includes(criticalityInput);

                if (matchesName && matchesId && matchesCriticality) {
                    card.style.display = 'block';
                    card.style.opacity = '0';
                    setTimeout(() => {
                        card.style.opacity = '1';
                    }, index * 50);
                    found = true;
                } else {
                    card.style.opacity = '0';
                    setTimeout(() => {
                        card.style.display = 'none';
                    }, 200);
                }
            });

            const emptyState = document.getElementById('emptyState');
            const isFiltering = nameInput !== '' || idInput !== '' || criticalityInput !== '';

            if (emptyState) {
                emptyState.style.display = (!found && isFiltering) ? 'block' : 'none';
            }
        }

        function setActiveNavLink() {
            const currentPath = window.location.pathname;
            const navLinks = document.querySelectorAll('.nav-link');

            navLinks.forEach(link => {
                link.classList.remove('active');
                const href = link.getAttribute('href');
                if (href && href === currentPath) {
                    link.classList.add('active');
                }
            });
        }

        document.addEventListener('DOMContentLoaded', function () {
            setActiveNavLink();

            const cards = document.querySelectorAll('.project-card');
            cards.forEach((card, index) => {
                card.style.opacity = '0';
                card.style.transform = 'translateY(20px)';
                setTimeout(() => {
                    card.style.transition = 'all 0.4s ease';
                    card.style.opacity = '1';
                    card.style.transform = 'translateY(0)';
                }, index * 100);
            });
        });

        document.addEventListener('keydown', function (e) {
            if (e.key === 'Escape') {
                document.getElementById('projectFilterInput').value = '';
                document.getElementById('projectIdFilterInput').value = '';
                document.getElementById('priorityFilterInput').value = '';
                document.getElementById('criticalityFilterInput').value = '';
                filterProjects();
            }
        });

        document.addEventListener('DOMContentLoaded', function () {
            const img = document.querySelector('.site-logo-img');
            if (!img) return;
            const url = img.getAttribute('src');
            fetch(url, { method: 'HEAD' })
                .then(resp => {
                    if (!resp.ok) {
                        console.warn('Logo static file not found (HEAD):', url, resp.status);
                        img.style.display = 'none';
                        const fb = document.getElementById('logoFallback');
                        if (fb) fb.style.display = 'flex';
                    }
                })
                .catch(err => {
                    console.warn('Logo HEAD check failed:', err, url);
                    img.style.display = 'none';
                    const fb = document.getElementById('logoFallback');
                    if (fb) fb.style.display = 'flex';
                });
        });

        function deleteProjectConfirmation(url, event) {
            if (event) {
                event.preventDefault();
                event.stopPropagation();
            }

            const project_id = url.split('/').filter(Boolean).pop();

            const confirmed = confirm(`Are you sure you want to delete Project ${project_id}? This action cannot be undone and will delete all associated test cases and groups.`);

            if (confirmed) {
                const form = document.createElement('form');
                form.method = 'POST';
                form.action = url;

                const csrfToken = document.querySelector('[name=csrfmiddlewaretoken]')?.value;

                if (!csrfToken) {
                    alert("Security Error: Cannot perform delete action (CSRF token missing).");
                    return;
                }

                const csrfInput = document.createElement('input');
                csrfInput.type = 'hidden';
                csrfInput.name = 'csrfmiddlewaretoken';
                csrfInput.value = csrfToken;
                form.appendChild(csrfInput);

                document.body.appendChild(form);
                form.submit();
            }
        }


    </script>
</body>

</html>


